{"version":3,"file":"UIStyleHandler-fO7Zx0Oy.js","sources":["../src/Engine/UI/Core/UIComponent.js","../src/Engine/UI/UIComponents/MainLayout.js","../src/Engine/UI/Core/UIRenderer.js","../src/Engine/UI/Core/UIStyle.js","../src/Engine/UI/Core/UIStyleHandler.js"],"sourcesContent":["import { WrongInstanceError } from \"@/Bundles/Errors\";\r\nimport { UIRenderer, UIStyle } from \"@/Bundles/UI\";\r\nimport { Observer, Entity, Vector2 } from \"@/Bundles/Core\";\r\nimport { TransformComponent } from \"@/Bundles/Core/Components\";\r\n\r\nclass UIComponent extends Entity {\r\n  #renderer;\r\n  #parent;\r\n  #children = [];\r\n  #root;\r\n  #tree = [];\r\n  #pendingTree = [];\r\n  setupDone = false;\r\n  reactToEvents = true;\r\n\r\n  uiManager;\r\n\r\n  datas = {\r\n    origin: new Vector2(),\r\n    defaultSlot: null,\r\n  };\r\n  slots = new Map();\r\n\r\n  eventObserver = new Observer({\r\n    click: \"click\",\r\n  });\r\n\r\n  transform = new TransformComponent();\r\n\r\n  get parent() {\r\n    return this.#parent;\r\n  }\r\n\r\n  get children() {\r\n    return this.#children;\r\n  }\r\n\r\n  get root() {\r\n    return this.#root;\r\n  }\r\n\r\n  get isRoot() {\r\n    return this.root === this;\r\n  }\r\n\r\n  get tree() {\r\n    return this.#tree;\r\n  }\r\n\r\n  get pendingTree() {\r\n    return this.#pendingTree;\r\n  }\r\n\r\n  set parent(parent) {\r\n    this.#parent = parent;\r\n  }\r\n\r\n  set root(root) {\r\n    this.#root = root;\r\n  }\r\n\r\n  set tree(tree) {\r\n    this.tree = tree;\r\n  }\r\n\r\n  constructor(...components) {\r\n    super(...components);\r\n    let uiStyle = components.find((component) => component instanceof UIStyle);\r\n    if (!uiStyle) {\r\n      this.addComponent(new UIStyle());\r\n    }\r\n  }\r\n\r\n  setup() {\r\n    this.setupDone = true;\r\n    this.setDefaultSlot(this);\r\n  }\r\n\r\n  addRenderer(renderer) {\r\n    if (!(renderer instanceof UIRenderer)) {\r\n      throw new WrongInstanceError(renderer, UIRenderer);\r\n    }\r\n\r\n    renderer.uiComponent = this;\r\n    renderer.setup();\r\n    this.#renderer = renderer;\r\n    return this;\r\n  }\r\n\r\n  setStyle(style) {\r\n    this.getComponent(UIStyle).setStyle(style);\r\n  }\r\n\r\n  setSlot(name, component) {\r\n    this.slots.set(name, component);\r\n  }\r\n\r\n  setDefaultSlot(child) {\r\n    this.setSlot(\"default\", child);\r\n  }\r\n\r\n  addChild(component, slotName = \"default\") {\r\n    component.parent = this;\r\n    component.uiManager = this.uiManager;\r\n\r\n    component.getComponent(UIStyle).styleHandler.indexInParent =\r\n      this.#tree.length;\r\n\r\n    let slot = this.slots.get(slotName) || this;\r\n    if (this.setupDone) {\r\n      slot.tree.push(component);\r\n    } else {\r\n      slot.pendingTree.push({ slot: slotName, component });\r\n    }\r\n\r\n    return this;\r\n  }\r\n\r\n  addEventListener(type, callback) {\r\n    this.eventObserver.$on(type, callback);\r\n  }\r\n\r\n  trigger(type, ...parameters) {\r\n    this.eventObserver.$emit(type, ...parameters);\r\n  }\r\n\r\n  loop(deltaTime, currentTime) {\r\n    this.#renderer?.loop();\r\n    this.#renderer?.render(this.scene.viewer, deltaTime, currentTime);\r\n  }\r\n}\r\nexport default UIComponent;\r\n","import { UIComponent, UIStyle } from \"@/Bundles/UI\";\r\n\r\nclass MainLayout extends UIComponent {\r\n  toProcess = [];\r\n  setup() {\r\n    this.root = this;\r\n    super.setup();\r\n    this.copyViewerTransform();\r\n  }\r\n\r\n  addChild(component) {\r\n    component.root = this.root;\r\n    component.scene = this.scene;\r\n\r\n    component.getComponent(UIStyle).setDefaultStyle(this.getComponent(UIStyle));\r\n    this.scene.add(component);\r\n    this.uiManager.add(component);\r\n    while (component.pendingTree.length > 0) {\r\n      let toHandle = component.pendingTree.shift();\r\n      let slot = component.slots.get(toHandle.slot) || component;\r\n      toHandle.component.parent = slot;\r\n\r\n      toHandle.component.getComponent(UIStyle).styleHandler.indexInParent =\r\n        slot.tree.length;\r\n      slot.tree.push(toHandle.component);\r\n    }\r\n    component.tree.forEach((ch) => this.addChild(ch));\r\n    return this;\r\n  }\r\n\r\n  copyViewerTransform() {\r\n    // .sub(this.component.scene.viewer.origin.clone().multiply(1))\r\n    this.transform.position.x = -this.scene.viewer.origin.x;\r\n    this.transform.position.y = -this.scene.viewer.origin.y;\r\n    this.transform.size.x = this.scene.viewer.size.x;\r\n    this.transform.size.y = this.scene.viewer.size.y;\r\n  }\r\n\r\n  loop() {\r\n    this.copyViewerTransform();\r\n    super.loop();\r\n  }\r\n}\r\n\r\nexport default MainLayout;\r\n","import { ImplementError } from \"@/Bundles/Errors\";\r\n\r\nclass UIRenderer {\r\n  uiComponent;\r\n  datas;\r\n\r\n  setup() {}\r\n  loop() {}\r\n\r\n  render() {\r\n    throw new ImplementError(\"render\", \"UIRenderer\");\r\n  }\r\n}\r\n\r\nexport default UIRenderer;\r\n","import { Component } from \"@/Bundles/Core\";\r\nimport { getProperties } from \"@/Bundles/Utils/Object\";\r\nimport { UIStyleHandler } from \"@/Bundles/UI\";\r\n\r\nclass UIStyle extends Component {\r\n  #inherit = false;\r\n  #needsUpdate = false;\r\n\r\n  #color;\r\n  #textColor;\r\n  #font;\r\n  #fontWeight;\r\n  #fontSize;\r\n  #borderRadius;\r\n  #borderWidth;\r\n  #borderColor;\r\n  #shadowColor;\r\n  #shadowBlur;\r\n  #shadowPosition;\r\n  #shadowSize;\r\n  #layout;\r\n  #margin;\r\n  #padding;\r\n  #width;\r\n  #height;\r\n  #direction;\r\n  #align;\r\n\r\n  constructor(style, inherit = false) {\r\n    super();\r\n\r\n    if (style) {\r\n      this.color = style.color || this.#color;\r\n      this.textColor = style.textColor || this.#textColor;\r\n      this.font = style.font || this.#font;\r\n      this.fontWeight = style.fontWeight || this.#fontWeight;\r\n      this.fontSize = style.fontSize || this.#fontSize;\r\n      this.borderRadius = style.borderRadius || this.#borderRadius;\r\n      this.borderWidth = style.borderWidth || this.#borderWidth;\r\n      this.borderColor = style.borderColor || this.#borderColor;\r\n      this.shadowColor = style.shadowColor || this.#shadowColor;\r\n      this.shadowBlur = style.shadowBlur || this.#shadowBlur;\r\n      this.shadowPosition = style.shadowPosition || this.#shadowPosition;\r\n      this.shadowSize = style.shadowSize || this.#shadowSize;\r\n      this.layout = style.layout || this.#layout;\r\n      this.margin = style.margin || this.#margin;\r\n      this.padding = style.padding || this.#padding;\r\n      this.width = style.width || this.#width;\r\n      this.height = style.height || this.#height;\r\n      this.direction = style.direction || this.#direction;\r\n      this.align = style.align || this.#align;\r\n    }\r\n\r\n    this.#inherit = inherit;\r\n  }\r\n\r\n  get color() {\r\n    return this.#color;\r\n  }\r\n  get textColor() {\r\n    return this.#textColor;\r\n  }\r\n  get font() {\r\n    return this.#font;\r\n  }\r\n  get fontWeight() {\r\n    return this.#fontWeight;\r\n  }\r\n  get fontSize() {\r\n    return this.#fontSize;\r\n  }\r\n  get borderRadius() {\r\n    return this.#borderRadius;\r\n  }\r\n  get borderWidth() {\r\n    return this.#borderWidth;\r\n  }\r\n  get borderColor() {\r\n    return this.#borderColor;\r\n  }\r\n  get shadowColor() {\r\n    return this.#shadowColor;\r\n  }\r\n  get shadowBlur() {\r\n    return this.#shadowBlur;\r\n  }\r\n  get shadowPosition() {\r\n    return this.#shadowPosition;\r\n  }\r\n  get shadowSize() {\r\n    return this.#shadowSize;\r\n  }\r\n  get layout() {\r\n    return this.#layout;\r\n  }\r\n  get margin() {\r\n    return this.#margin;\r\n  }\r\n  get padding() {\r\n    return this.#padding;\r\n  }\r\n  get width() {\r\n    return this.#width;\r\n  }\r\n  get height() {\r\n    return this.#height;\r\n  }\r\n  get direction() {\r\n    return this.#direction;\r\n  }\r\n  get align() {\r\n    return this.#align;\r\n  }\r\n  get needsUpdate() {\r\n    return this.#needsUpdate;\r\n  }\r\n  get inherit() {\r\n    return this.#inherit;\r\n  }\r\n\r\n  set color(color) {\r\n    this.#color = color;\r\n    this.needsUpdate = true;\r\n  }\r\n  set textColor(textColor) {\r\n    this.#textColor = textColor;\r\n    this.needsUpdate = true;\r\n  }\r\n  set font(font) {\r\n    this.#font = font;\r\n    this.needsUpdate = true;\r\n  }\r\n  set fontWeight(fontWeight) {\r\n    this.#fontWeight = fontWeight;\r\n    this.needsUpdate = true;\r\n  }\r\n  set fontSize(fontSize) {\r\n    this.#fontSize = fontSize;\r\n    this.needsUpdate = true;\r\n  }\r\n  set borderRadius(borderRadius) {\r\n    this.#borderRadius = borderRadius;\r\n    this.needsUpdate = true;\r\n  }\r\n  set borderWidth(borderWidth) {\r\n    this.#borderWidth = borderWidth;\r\n    this.needsUpdate = true;\r\n  }\r\n  set borderColor(borderColor) {\r\n    this.#borderColor = borderColor;\r\n    this.needsUpdate = true;\r\n  }\r\n  set shadowColor(shadowColor) {\r\n    this.#shadowColor = shadowColor;\r\n    this.needsUpdate = true;\r\n  }\r\n  set shadowBlur(shadowBlur) {\r\n    this.#shadowBlur = shadowBlur;\r\n    this.needsUpdate = true;\r\n  }\r\n  set shadowPosition(shadowPosition) {\r\n    this.#shadowPosition = shadowPosition;\r\n    this.needsUpdate = true;\r\n  }\r\n  set shadowSize(shadowSize) {\r\n    this.#shadowSize = shadowSize;\r\n    this.needsUpdate = true;\r\n  }\r\n  set layout(layout) {\r\n    this.#layout = layout;\r\n    this.needsUpdate = true;\r\n  }\r\n  set margin(margin) {\r\n    this.#margin = margin;\r\n    this.needsUpdate = true;\r\n  }\r\n  set padding(padding) {\r\n    this.#padding = padding;\r\n    this.needsUpdate = true;\r\n  }\r\n  set width(width) {\r\n    this.#width = width;\r\n    this.needsUpdate = true;\r\n  }\r\n  set height(height) {\r\n    this.#height = height;\r\n    this.needsUpdate = true;\r\n  }\r\n  set direction(direction) {\r\n    this.#direction = direction;\r\n    this.needsUpdate = true;\r\n  }\r\n  set needsUpdate(needsUpdate) {\r\n    this.#needsUpdate = needsUpdate;\r\n  }\r\n  set align(align) {\r\n    this.#align = align;\r\n  }\r\n\r\n  setup() {\r\n    this.styleHandler = new UIStyleHandler(this);\r\n  }\r\n\r\n  loop() {\r\n    this.styleHandler.handleStyle();\r\n  }\r\n\r\n  setDefaultStyle(style) {\r\n    let thisStyle = this.entity.getComponent(UIStyle);\r\n    Object.keys(getProperties(style)).forEach((prop) => {\r\n      if (prop !== \"inherit\") {\r\n        if (thisStyle[prop] === undefined) {\r\n          thisStyle[prop] = style[prop];\r\n        }\r\n      }\r\n    });\r\n  }\r\n\r\n  setStyle(style, overwrite = true, isDefault = false) {\r\n    let thisStyle = this.entity.getComponent(UIStyle);\r\n\r\n    let styleValues = style;\r\n    if (style instanceof UIStyle) {\r\n      styleValues = getProperties(style);\r\n    }\r\n    Object.keys(styleValues).forEach((prop) => {\r\n      if (prop !== \"inherit\") {\r\n        if (overwrite) {\r\n          if (styleValues[prop] !== undefined) {\r\n            thisStyle[prop] = styleValues[prop] || thisStyle[prop];\r\n          }\r\n        } else {\r\n          if (isDefault) {\r\n            if (thisStyle[prop] === undefined) {\r\n              thisStyle[prop] = styleValues[prop];\r\n            }\r\n          } else {\r\n            thisStyle[prop] = thisStyle[prop] || styleValues[prop];\r\n          }\r\n        }\r\n      }\r\n    });\r\n  }\r\n}\r\n\r\nexport default UIStyle;\r\n\r\n//   width: \"100%\" || \"100px\",\r\n//   height: \"100%\" || \"100px\",\r\n//   direction: \"horizontal\" || \"vertical\",\r\n//   padding: [\"100%\" || \"100px\"] || [\r\n//       \"100%\" || \"100px\",\r\n//       \"100%\" || \"100px\",\r\n//     ] || [\"100%\" || \"100px\", \"100%\" || \"100px\", \"100%\" || \"100px\"] || [\r\n//       \"100%\" || \"100px\",\r\n//       \"100%\" || \"100px\",\r\n//       \"100%\" || \"100px\",\r\n//       \"100%\" || \"100px\",\r\n//     ],\r\n//   margin: [\"100%\" || \"100px\"] || [\"100%\" || \"100px\", \"100%\" || \"100px\"] || [\r\n//       \"100%\" || \"100px\",\r\n//       \"100%\" || \"100px\",\r\n//       \"100%\" || \"100px\",\r\n//     ] || [\r\n//       \"100%\" || \"100px\",\r\n//       \"100%\" || \"100px\",\r\n//       \"100%\" || \"100px\",\r\n//       \"100%\" || \"100px\",\r\n//     ],\r\n//   layout: \"absolute\" || \"relative\",\r\n//   color: new RGB(),\r\n//   textColor: new RGB(),\r\n//   // font: new Font(),\r\n//   fontWeight: \"800\",\r\n//   fontSize: \"10%\" || \"20px\",\r\n//   borderRadius: [\"100%\" || \"100px\"] || [\r\n//       \"100%\" || \"100px\",\r\n//       \"100%\" || \"100px\",\r\n//     ] || [\"100%\" || \"100px\", \"100%\" || \"100px\", \"100%\" || \"100px\"] || [\r\n//       \"100%\" || \"100px\",\r\n//       \"100%\" || \"100px\",\r\n//       \"100%\" || \"100px\",\r\n//       \"100%\" || \"100px\",\r\n//     ],\r\n//   border: [\"100%\" || \"100px\"] || [\"100%\" || \"100px\", \"100%\" || \"100px\"] || [\r\n//       \"100%\" || \"100px\",\r\n//       \"100%\" || \"100px\",\r\n//       \"100%\" || \"100px\",\r\n//     ] || [\r\n//       \"100%\" || \"100px\",\r\n//       \"100%\" || \"100px\",\r\n//       \"100%\" || \"100px\",\r\n//       \"100%\" || \"100px\",\r\n//     ],\r\n//   borderWidth: [\"100%\" || \"100px\"] || [\r\n//       \"100%\" || \"100px\",\r\n//       \"100%\" || \"100px\",\r\n//     ] || [\"100%\" || \"100px\", \"100%\" || \"100px\", \"100%\" || \"100px\"] || [\r\n//       \"100%\" || \"100px\",\r\n//       \"100%\" || \"100px\",\r\n//       \"100%\" || \"100px\",\r\n//       \"100%\" || \"100px\",\r\n//     ],\r\n//   borderColor: new RGB(),\r\n//   shadowColor: new RGB(),\r\n//   shadowBlur: \"100%\" || \"100px\",\r\n//   shadowPosition: [\"100%\" || \"100px\", \"100%\" || \"100px\"],\r\n//   shadowSize: [\"100%\" || \"100px\", \"100%\" || \"100px\"],\r\n","import { WrongInstanceError } from \"@/Bundles/Errors\";\r\nimport { UIStyle } from \"@/Bundles/UI\";\r\nimport { Vector2 } from \"@/Bundles/Core\";\r\n\r\nclass UIStyleHandler {\r\n  #component;\r\n\r\n  #style;\r\n  indexInParent = 0;\r\n\r\n  datas = {\r\n    size: new Vector2(),\r\n    margin: [0, 0, 0, 0],\r\n  };\r\n\r\n  constructor(uiStyle) {\r\n    if (!(uiStyle instanceof UIStyle)) {\r\n      throw new WrongInstanceError(uiStyle, UIStyle);\r\n    }\r\n\r\n    this.style = uiStyle;\r\n    this.component = uiStyle.entity;\r\n  }\r\n\r\n  get component() {\r\n    return this.#component;\r\n  }\r\n\r\n  get style() {\r\n    return this.#style;\r\n  }\r\n\r\n  get parent() {\r\n    return this.#component.parent || this.#component.root;\r\n  }\r\n\r\n  get lastSibling() {\r\n    return this.parent.tree[this.indexInParent - 1];\r\n  }\r\n\r\n  get lastSiblingStyleHandler() {\r\n    return this.lastSibling?.getComponent(UIStyle)?.styleHandler;\r\n  }\r\n\r\n  set style(style) {\r\n    this.#style = style;\r\n  }\r\n\r\n  set component(component) {\r\n    this.#component = component;\r\n  }\r\n\r\n  autoHeightParent(parent, current) {\r\n    let parentStyle = parent.getComponent(UIStyle);\r\n    let currentStyle = current.getComponent(UIStyle);\r\n    if (parentStyle.height === \"auto\") {\r\n      parentStyle.styleHandler.datas.size.y =\r\n        currentStyle.styleHandler.getNextFreePosition(parent).y;\r\n      parent.transform.size.y =\r\n        currentStyle.styleHandler.getNextFreePosition(parent).y;\r\n      // TODO parent.transform.size.x = this.getNextFreePosition().x;\r\n    }\r\n\r\n    current = parent;\r\n    parent = parent.parent;\r\n    if (\r\n      parent &&\r\n      parent !== this.#component.root &&\r\n      parentStyle.height === \"auto\"\r\n    ) {\r\n      this.autoHeightParent(parent, current);\r\n    }\r\n  }\r\n\r\n  calculateSize(parentTransform) {\r\n    let x = 0;\r\n    let y = 0;\r\n\r\n    // Calculate width\r\n    if (this.style.width) {\r\n      if (typeof this.style.width === \"number\") {\r\n        x = this.style.width;\r\n      } else if (typeof this.style.width === \"string\") {\r\n        if (this.style.width.endsWith(\"%\")) {\r\n          let value = parseFloat(this.style.width.replace(\"%\", \"\"));\r\n          x = parentTransform.size.x * (value / 100);\r\n        } else if (this.style.width.endsWith(\"px\")) {\r\n          let value = parseFloat(this.style.width.replace(\"px\", \"\"));\r\n          x = value;\r\n        } else {\r\n          x = this.style.width;\r\n        }\r\n      }\r\n    }\r\n\r\n    // Calculate height\r\n    if (this.style.height) {\r\n      if (typeof this.style.height === \"number\") {\r\n        y = this.style.height;\r\n      } else if (typeof this.style.height === \"string\") {\r\n        if (this.style.height.endsWith(\"%\")) {\r\n          let value = parseFloat(this.style.height.replace(\"%\", \"\"));\r\n          y = parentTransform.size.y * (value / 100);\r\n        } else if (this.style.height.endsWith(\"px\")) {\r\n          let value = parseFloat(this.style.height.replace(\"px\", \"\"));\r\n          y = value;\r\n        } else {\r\n          y = this.style.height;\r\n        }\r\n      }\r\n    }\r\n\r\n    this.datas.size.x = x;\r\n    this.datas.size.y = y;\r\n\r\n    if (this.style.margin) {\r\n      let value = this.style.margin;\r\n      if (!Array.isArray(value)) {\r\n        value = [value, value, value, value];\r\n      } else if (value.length === 1) {\r\n        value = [value[0], value[0], value[0], value[0]];\r\n      } else if (value.length === 2) {\r\n        value = [value[0], value[1], value[0], value[1]];\r\n      } else if (value.length === 3) {\r\n        value = [value[0], value[1], value[1], value[2]];\r\n      }\r\n      value = value.map((val, index) => {\r\n        if (typeof val === \"number\") {\r\n          return val;\r\n        } else if (val.endsWith(\"%\")) {\r\n          let v = parseFloat(val.replace(\"%\", \"\"));\r\n          let axe = [0, 2].includes(index)\r\n            ? parentTransform.size.y\r\n            : parentTransform.size.x;\r\n          return axe * (v / 100);\r\n        } else if (val.endsWith(\"px\")) {\r\n          let v = parseFloat(val.replace(\"px\", \"\"));\r\n          return v;\r\n        } else {\r\n          return parseFloat(val);\r\n        }\r\n      });\r\n      if (this.style.direction === \"vertical\") {\r\n        // if (x + value[1] + value[3] > parentTransform.size.x) {\r\n        x -= value[1] + value[3];\r\n        // } else {\r\n        // }\r\n      } else if (this.style.direction === \"horizontal\") {\r\n        y -= value[0] + value[2];\r\n      }\r\n      this.datas.margin = value;\r\n    }\r\n\r\n    return new Vector2(Math.max(0, x), Math.max(0, y));\r\n  }\r\n\r\n  getNextFreePosition(component, index) {\r\n    let nextFreePosition = new Vector2();\r\n    if (component) {\r\n      let componentStyle = component.getComponent(UIStyle);\r\n      let children = component.tree;\r\n      if (index !== undefined) {\r\n        children = children.slice(0, index);\r\n      }\r\n      children.forEach((child) => {\r\n        let childDatas = child.getComponent(UIStyle).styleHandler.datas;\r\n        if (componentStyle.direction === \"vertical\") {\r\n          nextFreePosition.y += childDatas.size.y;\r\n          nextFreePosition.y += childDatas.margin[0] + childDatas.margin[2];\r\n        } else {\r\n          nextFreePosition.x += child.size.x;\r\n          nextFreePosition.x += childDatas.margin[1] + childDatas.margin[3];\r\n        }\r\n      });\r\n    }\r\n    return nextFreePosition;\r\n  }\r\n\r\n  calculatePosition(parentTransform) {\r\n    let x =\r\n      parentTransform.position.x +\r\n      (this.style.direction === \"horizontal\"\r\n        ? this.getNextFreePosition(this.#component.parent, this.indexInParent)\r\n            .x || 0\r\n        : 0);\r\n    let y =\r\n      parentTransform.position.y +\r\n      (this.style.direction === \"vertical\"\r\n        ? this.getNextFreePosition(this.#component.parent, this.indexInParent)\r\n            .y || 0\r\n        : 0);\r\n\r\n    if (this.style.margin) {\r\n      let value = this.style.margin;\r\n      if (!Array.isArray(value)) {\r\n        value = [value, value, value, value];\r\n      } else if (value.length === 1) {\r\n        value = [value[0], value[0], value[0], value[0]];\r\n      } else if (value.length === 2) {\r\n        value = [value[0], value[1], value[0], value[1]];\r\n      } else if (value.length === 3) {\r\n        value = [value[0], value[1], value[1], value[2]];\r\n      }\r\n      value = value.map((val, index) => {\r\n        if (typeof val === \"number\") {\r\n          return val;\r\n        } else if (val.endsWith(\"%\")) {\r\n          let v = parseFloat(val.replace(\"%\", \"\"));\r\n          let axe = [0, 2].includes(index)\r\n            ? parentTransform.size.y\r\n            : parentTransform.size.x;\r\n          return axe * (v / 100);\r\n        } else if (val.endsWith(\"px\")) {\r\n          let v = parseFloat(val.replace(\"px\", \"\"));\r\n          return v;\r\n        } else {\r\n          return parseFloat(val);\r\n        }\r\n      });\r\n      x += value[3];\r\n      y += value[0];\r\n    }\r\n\r\n    let parentStyle = this.parent.getComponent(UIStyle);\r\n    if (parentStyle.align && parentStyle.align === \"center\") {\r\n      if (parentStyle.direction === \"horizontal\") {\r\n        y +=\r\n          parentTransform.size.y / 2 -\r\n          this.component.transform.size.y / 2 -\r\n          this.datas.margin[0] / 2 -\r\n          this.datas.margin[2] / 2;\r\n      } else {\r\n        x +=\r\n          parentTransform.size.x / 2 -\r\n          this.component.transform.size.x / 2 -\r\n          this.datas.margin[1] / 2 -\r\n          this.datas.margin[3] / 2;\r\n      }\r\n    }\r\n    return new Vector2(x, y);\r\n  }\r\n\r\n  handleStyle() {\r\n    let parentTransform = this.component.parent?.transform;\r\n    if (!parentTransform || this.style.layout === \"absolute\") {\r\n      parentTransform = this.component.root.transform;\r\n    }\r\n\r\n    if (!this.component.isRoot) {\r\n      this.component.transform.size = this.calculateSize(parentTransform);\r\n      this.component.transform.position =\r\n        this.calculatePosition(parentTransform);\r\n    }\r\n\r\n    if (\r\n      this.component.parent &&\r\n      this.component.parent !== this.component.root\r\n    ) {\r\n      this.autoHeightParent(\r\n        this.component.parent || this.component.root,\r\n        this.component\r\n      );\r\n    }\r\n  }\r\n}\r\n\r\nexport default UIStyleHandler;\r\n"],"names":["Entity","Vector2","Observer","TransformComponent","WrongInstanceError","ImplementError","Component","getProperties"],"mappings":"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"}